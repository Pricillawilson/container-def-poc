{
  "version": 4,
  "terraform_version": "1.0.11",
  "serial": 14,
  "lineage": "43d50a17-5379-1eb2-21a2-45819a5d2570",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "aws_iam_policy_document",
      "name": "ecs_task_execution_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "320642683",
            "json": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ecs-tasks.amazonaws.com\"\n      }\n    }\n  ]\n}",
            "override_json": null,
            "override_policy_documents": null,
            "policy_id": null,
            "source_json": null,
            "source_policy_documents": null,
            "statement": [
              {
                "actions": [
                  "sts:AssumeRole"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [
                  {
                    "identifiers": [
                      "ecs-tasks.amazonaws.com"
                    ],
                    "type": "Service"
                  }
                ],
                "resources": [],
                "sid": ""
              }
            ],
            "version": "2012-10-17"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "app",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "63ba9212b1af2771082718df9ebe4d5021ab1367eeac9d0b69695f794b4d7010",
            "rendered": "[\n    {\n      \"name\": \"game\",\n      \"image\": \"824953368197.dkr.ecr.ap-south-1.amazonaws.com/game:1.0\",\n      \"cpu\": 128,\n      \"memory\": 256,\n      \"networkMode\": \"awsvpc\",\n      \"logConfiguration\": {\n          \"logDriver\": \"awslogs\",\n          \"options\": {\n            \"awslogs-group\": \"/ecs/app\",\n            \"awslogs-region\": \"ap-south-1\",\n            \"awslogs-stream-prefix\": \"ecs\"\n          }\n      },\n      \"portMappings\": [\n        {\n          \"containerPort\": 8080\n          \n        }\n      ]\n    },\n\n    {\n       \"name\" : \"drupal\",\n       \"image\" : \"824953368197.dkr.ecr.ap-south-1.amazonaws.com/drupal:1.0\",\n       \n       \"memory\": 256,\n       \"networkMode\" : \"awsvpc\",\n       \"portMappings\" : [\n         {\n           \"containerPort\" : 80\n         }\n       ] \n       \n    }\n\n  ]",
            "template": "[\n    {\n      \"name\": \"${game_name}\",\n      \"image\": \"${game_image}\",\n      \"cpu\": ${game_cpu},\n      \"memory\": ${game_memory},\n      \"networkMode\": \"awsvpc\",\n      \"logConfiguration\": {\n          \"logDriver\": \"awslogs\",\n          \"options\": {\n            \"awslogs-group\": \"/ecs/app\",\n            \"awslogs-region\": \"${aws_region}\",\n            \"awslogs-stream-prefix\": \"ecs\"\n          }\n      },\n      \"portMappings\": [\n        {\n          \"containerPort\": ${game_port}\n          \n        }\n      ]\n    },\n\n    {\n       \"name\" : \"${drupal_name}\",\n       \"image\" : \"${drupal_image}\",\n       \n       \"memory\": ${drupal_memory},\n       \"networkMode\" : \"awsvpc\",\n       \"portMappings\" : [\n         {\n           \"containerPort\" : ${drupal_port}\n         }\n       ] \n       \n    }\n\n  ]",
            "vars": {
              "aws_region": "ap-south-1",
              "drupal_image": "824953368197.dkr.ecr.ap-south-1.amazonaws.com/drupal:1.0",
              "drupal_memory": "256",
              "drupal_name": "drupal",
              "drupal_port": "80",
              "game_cpu": "128",
              "game_image": "824953368197.dkr.ecr.ap-south-1.amazonaws.com/game:1.0",
              "game_memory": "256",
              "game_name": "game",
              "game_port": "8080"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ecs_task_definition",
      "name": "ecs_task_def",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ecs:ap-south-1:824953368197:task-definition/BT:2",
            "container_definitions": "[{\"cpu\":128,\"environment\":[],\"essential\":true,\"image\":\"824953368197.dkr.ecr.ap-south-1.amazonaws.com/game:1.0\",\"logConfiguration\":{\"logDriver\":\"awslogs\",\"options\":{\"awslogs-group\":\"/ecs/app\",\"awslogs-region\":\"ap-south-1\",\"awslogs-stream-prefix\":\"ecs\"}},\"memory\":256,\"mountPoints\":[],\"name\":\"game\",\"portMappings\":[{\"containerPort\":8080,\"hostPort\":8080,\"protocol\":\"tcp\"}],\"volumesFrom\":[]},{\"cpu\":0,\"environment\":[],\"essential\":true,\"image\":\"824953368197.dkr.ecr.ap-south-1.amazonaws.com/drupal:1.0\",\"memory\":256,\"mountPoints\":[],\"name\":\"drupal\",\"portMappings\":[{\"containerPort\":80,\"hostPort\":80,\"protocol\":\"tcp\"}],\"volumesFrom\":[]}]",
            "cpu": "256",
            "ephemeral_storage": [],
            "execution_role_arn": "arn:aws:iam::824953368197:role/ecs-task-role",
            "family": "BT",
            "id": "BT",
            "inference_accelerator": [],
            "ipc_mode": "",
            "memory": "512",
            "network_mode": "awsvpc",
            "pid_mode": "",
            "placement_constraints": [],
            "proxy_configuration": [],
            "requires_compatibilities": [
              "FARGATE"
            ],
            "revision": 2,
            "runtime_platform": [],
            "skip_destroy": false,
            "tags": null,
            "tags_all": {},
            "task_role_arn": "",
            "volume": []
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_iam_role.ecs_task_execution_role",
            "data.template_file.app"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "ecs_task_execution_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::824953368197:role/ecs-task-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2022-04-18T08:01:34Z",
            "description": "",
            "force_detach_policies": false,
            "id": "ecs-task-role",
            "inline_policy": [
              {
                "name": "",
                "policy": ""
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
            ],
            "max_session_duration": 3600,
            "name": "ecs-task-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "tags_all": {},
            "unique_id": "AROA4AEYNN2CYGBZ62IFI"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.aws_iam_policy_document.ecs_task_execution_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "ecs_task_execution_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "ecs-task-role-20220418080136803000000001",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy",
            "role": "ecs-task-role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.aws_iam_policy_document.ecs_task_execution_role",
            "aws_iam_role.ecs_task_execution_role"
          ]
        }
      ]
    }
  ]
}
